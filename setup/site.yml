---

- name: Bootstrap Ansible settings
  hosts: localhost

  vars_prompt:
    - name: vault_password
      prompt: Enter vault password
    - name: email
      prompt: Enter email address
      private: false
    - name: work_system
      prompt: System belongs to employer (true|false)
      private: false

  tasks:
    - name: Create vault file
      ansible.builtin.copy:
        content: "{{ vault_password }}"
        dest: "{{ ansible_user_dir }}/.ansible/vault"
        mode: 0600
      tags: vault

    - name: Create inventory
      ansible.builtin.template:
        src: inventory.json.j2
        dest: "{{ ansible_env['PWD'] | dirname }}/inventory.json"
        mode: 0755
      tags: inventory
