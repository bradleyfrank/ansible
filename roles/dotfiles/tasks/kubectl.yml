---
# tasks file for dotfiles

- name: Find latest kubectl release
  ansible.builtin.get_url:
    url: https://dl.k8s.io/release/stable.txt
    dest: "/tmp/stable.txt"

- name: Install kubectl
  vars:
    url: https://storage.googleapis.com/kubernetes-release/release
    system: "{{ ansible_system | lower }}"
    release: "{{ lookup('file', '/tmp/stable.txt') }}"
  ansible.builtin.get_url:
    url: "{{ url }}/{{ release }}/bin/{{ system }}/amd64/kubectl"
    dest: "{{ ansible_user_dir }}/.local/bin/"
    mode: 0755
