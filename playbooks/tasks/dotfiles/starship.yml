---

- name: Download Starship tarball
  ansible.builtin.get_url:
    url: "{{ starship['tarball'] }}"
    dest: /tmp/starship.tar.gz
    mode: 0644
  tags: starship

- name: Run Starship installer
  block:
    - name: Extract Starship installer
      ansible.builtin.unarchive:
        src: /tmp/starship.tar.gz
        dest: "{{ ansible_user_dir }}/.local/bin/"
    - name: Make Starship executable
      ansible.builtin.file:
        path: "{{ ansible_user_dir }}/.local/bin/starship"
        mode: 0755
  always:
    - name: Remove Starship tarball
      ansible.builtin.file:
        path: /tmp/starship.tar.gz
        state: absent
  tags: starship
