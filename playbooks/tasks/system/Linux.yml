---

- name: Make zsh default for user
  ansible.builtin.user:
    name: "{{ ansible_user_id }}"
    shell: "/usr/bin/zsh"
  become: true

- name: Import dconf settings
  ansible.builtin.shell: "dconf load / < {{ item }}"
  with_fileglob:
    - "conf/Gnome/common.dconf"
    - "conf/Gnome/{{ ansible_distribution }}.dconf"

- name: Generate host keys
  ansible.builtin.command:
    cmd: ssh-keygen -A
    creates: /etc/ssh/ssh_host_*_key
  become: true

- name: Secure SSH settings
  import_role:
    name: devsec.hardening.ssh_hardening
  become: true
