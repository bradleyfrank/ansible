---

- name: Remove files, folder, and packages
  hosts: localhost

  vars:
    dotfiles:
      - .ansible_vault_password
      - .config/p10k.zsh
      - .dotfiles
      - .k9s
      - .local/bin/diff-so-fancy
      - .local/bin/gcp-kubeconfigs
      - .local/bin/gcpkonfig
      - .local/bin/lib
      - .local/bin/orm
      - .local/opt/bbdm
      - .local/share/fubectl
      - .local/share/icons
      - .local/share/kubectl
      - .local/share/zsh-completion
      - .local/share/zshrc

    homebrew:
      formulas:
        - diff-so-fancy
        - ffsend
        - hstr
        - tmux-mem-cpu-load
        - yq
        - youtube-dl
      casks:
        - anylist
        - firefox-developer-edition
        - firefox-nightly
        - joplin
        - qownnotes
        - openshot-video-editor
        - parallels
        - raindropio
        - starship
        - stay
        - sublime-text
        - typora
        - virtualbox
        - vivaldi
        - xquartz

    flatpaks:
      - name: com.github.fabiocolacio.marker
      - name: com.github.geigi.cozy
      - name: com.github.johnfactotum.Foliate
      - name: com.github.PintaProject.Pinta
      - name: com.gitlab.newsflash
      - name: com.spotify.Client
      - name: net.cozic.joplin_desktop
      - name: org.gabmus.hydrapaper
      - name: org.gnome.Connections
      - name: org.gnome.Games
      - name: org.gnome.gitlab.somas.Apostrophe
      - name: org.gnome.gThumb
      - name: org.gnome.TextEditor

  tasks:
    - name: Remove files
      ansible.builtin.file:
        path: "{{ ansible_user_dir }}/{{ item }}"
        state: absent
      loop: "{{ dotfiles }}"

    - name: Uninstall Homebrew formulas
      community.general.homebrew:
        name: "{{ homebrew['formulas'] }}"
        state: absent
      when: "'MacOSX' in ansible_distribution"

    - name: Uninstall Homebrew casks
      community.general.homebrew_cask:
        name: "{{ homebrew['casks'] }}"
        state: absent
      when: "'MacOSX' in ansible_distribution"

    - name: Remove flatpak packages
      community.general.flatpak:
        name: "{{ item['name'] }}"
        state: absent
        method: user
        remote: "{{ item['remote'] | default('flathub') }}"
      loop: "{{ flatpaks }}"
      when: "'Fedora' in ansible_distribution"
