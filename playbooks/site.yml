---

- name: "Run all the things"
  hosts: all
  tasks:

    # SET GROUPS

    - name: "Add host to 'system' group"
      ansible.builtin.group_by:
        key: "{{ ansible_facts['system'] }}"
      tags: [always]

    - name: "Add host to 'distribution' group"
      ansible.builtin.group_by:
        key: "{{ ansible_facts['distribution'] }}"
      tags: [always]

    # ROLE IMPORTS

    - name: "Import packages role"
      ansible.builtin.import_role:
        name: "packages"

    - name: "Import system role"
      ansible.builtin.import_role:
        name: "system"

    - name: "Import dotfiles role"
      ansible.builtin.import_role:
        name: "dotfiles"

    - name: "Import ssh role"
      ansible.builtin.import_role:
        name: "ssh"

    - name: "Import git role"
      ansible.builtin.import_role:
        name: "git"

    - name: "Import desktop role"
      ansible.builtin.import_role:
        name: "desktop"

    - name: "Import vim role"
      ansible.builtin.import_role:
        name: "vim"

    - name: "Import cloud role"
      ansible.builtin.import_role:
        name: "cloud"

    - name: "Import Zsh role"
      ansible.builtin.import_role:
        name: "zsh"

    - name: "Import tmux role"
      ansible.builtin.import_role:
        name: "tmux"
